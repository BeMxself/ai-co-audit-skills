# AI Co-Audit Skills — 实现审计

[中文](README.md) | [English](README.en.md)

一组以 Claude Code 插件为主的“实现审计”skills 与自动化脚本，用于 Claude + Codex 协作审计并输出最终报告。

## 安装

### Claude Code（插件）

在 Claude Code 中把本 GitHub 仓库添加为插件市场（Marketplace）：

```text
/plugin marketplace add BeMxself/ai-co-audit-skills
```

然后安装插件：

```text
/plugin install implementation-audit@BeMxself-ai-co-audit-skills
```

安装完成后，可用 `/implementation-audit` 调用相关技能。

注意：自动化 `run` / `continue` 会调用 `claude` CLI，无法在 Claude Code 会话内嵌套执行。在 Claude Code 中应只完成初始化并输出命令指南，然后在独立终端运行，或使用 `--dry-run` 仅生成 prompts。

### Codex (Skills)

Codex 会从以下位置扫描 skills：
- 项目级 `.agents/skills/`（从当前目录向上到仓库根目录）
- 用户级 `$HOME/.agents/skills/`

方式 A（推荐）：在 Codex 内使用 `$skill-installer` 从 GitHub 安装

```text
$skill-installer 请从 GitHub 仓库 BeMxself/ai-co-audit-skills 安装以下 skills：
- skills/implementation-audit
```

安装完成后，重启 Codex 以加载新 skills。

方式 B：手动同步（rsync）

用户级安装：

```bash
mkdir -p ~/.agents/skills
rsync -a skills/ ~/.agents/skills/
```

项目级安装（在你的目标项目目录执行）：

```bash
mkdir -p .agents/skills
rsync -a /path/to/ai-co-audit-skills/skills/ .agents/skills/
```

后续更新同样重复执行对应的 `rsync` 命令即可。

### Kiro CLI (Skills)（可选）

Kiro CLI 可以从 `.kiro/skills/**/SKILL.md`（workspace 级别）加载 skills，并通过 agent profile 使用。

1) 将 skills 安装到当前仓库/workspace：

```bash
mkdir -p .kiro/skills
rsync -a skills/ .kiro/skills/
```

2) 创建一个包含 skills resources 的 agent（此命令会打开编辑器）：

```bash
mkdir -p .kiro/agents
kiro-cli agent create --name "AI Co-Audit Agent" --directory .kiro/agents
```

3) 在 `.kiro/agents/ai_co_audit_agent.json` 中加入 resources 配置（示例）：

```json
{ "resources": ["skill://.kiro/skills/**/SKILL.md"] }
```

4) 用该 agent 启动对话：

```bash
kiro-cli chat --agent "AI Co-Audit Agent"
```

## 包含的 Skills

- `skills/implementation-audit/`
  - `SKILL.md`: skill 指令
  - `automation-ref/`: 自动化脚本的源参考

## implementation-audit 概览

该 skill 会把自动化脚本同步到 `automation/implementation-audit/`，并支持：

- 任务初始化：`init.sh`
- 执行：`.ai-workflows/<task-id>/run`
- 断点续跑：`.ai-workflows/<task-id>/continue`
- 手工恢复：`--from-phase` / `--from-round`

更完整说明见 `skills/implementation-audit/automation-ref/README.md`。

## 快速开始

初始化任务：

```bash
bash automation/implementation-audit/init.sh \
  --input docs/plans/2026-02-11-security-external-auth-design.md
```

运行任务：

```bash
./.ai-workflows/<auto-generated-task-id>/run
```

断点续跑：

```bash
./.ai-workflows/<auto-generated-task-id>/continue
```

## 资产同步模式

使用参考同步脚本：

```bash
bash automation/implementation-audit/sync-automation.sh \
  <path-to-ai-co-audit-skills>/skills/implementation-audit/automation-ref \
  automation/implementation-audit
```

需要强制覆盖时：

```bash
bash automation/implementation-audit/sync-automation.sh \
  <path-to-ai-co-audit-skills>/skills/implementation-audit/automation-ref \
  automation/implementation-audit \
  --auto-copy
```
