# AI Co-Audit Skills — 实现审计

[中文](README.md) | [English](README.en.md)

一组“实现审计”skills 与自动化脚本，提供 **Claude Code 版** 与 **Kiro CLI 版** 两套分离工作流，用于 AI 协作审计并输出最终报告。

## 安装

### Claude Code（插件）

在 Claude Code 中把本 GitHub 仓库添加为插件市场（Marketplace）：

```text
/plugin marketplace add BeMxself/ai-co-audit-skills
```

然后安装插件：

```text
/plugin install implementation-audit@BeMxself-ai-co-audit-skills
```

安装完成后，可用 `/implementation-audit` 调用相关技能。

注意：自动化 `run` / `continue` 会调用 `claude` CLI，无法在 Claude Code 会话内嵌套执行。在 Claude Code 中应只完成初始化并输出命令指南，然后在独立终端运行，或使用 `--dry-run` 仅生成 prompts。

### Codex (Skills)

Codex 会从以下位置扫描 skills：
- 项目级 `.agents/skills/`（从当前目录向上到仓库根目录）
- 用户级 `$HOME/.agents/skills/`

方式 A（推荐）：在 Codex 内使用 `$skill-installer` 从 GitHub 安装

```text
$skill-installer 请从 GitHub 仓库 BeMxself/ai-co-audit-skills 安装以下 skills：
- skills/implementation-audit
- skills/implementation-audit-kiro
```

安装完成后，重启 Codex 以加载新 skills。

方式 B：手动同步（rsync）

用户级安装：

```bash
mkdir -p ~/.agents/skills
rsync -a skills/ ~/.agents/skills/
```

项目级安装（在你的目标项目目录执行）：

```bash
mkdir -p .agents/skills
rsync -a /path/to/ai-co-audit-skills/skills/ .agents/skills/
```

后续更新同样重复执行对应的 `rsync` 命令即可。

### Kiro CLI (Skills)（独立安装）

Kiro CLI 版请安装独立 skill：`implementation-audit-kiro`。不要与 Claude Code 插件路径混用。

1) 安装 Kiro skill 到目标项目：

```bash
mkdir -p .kiro/skills
rsync -a /path/to/ai-co-audit-skills/skills/implementation-audit-kiro .kiro/skills/
```

2) 在目标项目生成 agent（模型可按需修改）：

```bash
bash .kiro/skills/implementation-audit-kiro/automation-ref/setup-kiro-agent.sh \
  --project-root "$(pwd)" \
  --agent-name ai-co-audit-kiro-opus \
  --model claude-opus-4.6
```

3) 用该 agent 启动 Kiro：

```bash
kiro-cli chat --agent ai-co-audit-kiro-opus
```

## 包含的 Skills

- `skills/implementation-audit/`
  - `SKILL.md`: skill 指令
  - `automation-ref/`: 自动化脚本的源参考
- `skills/implementation-audit-kiro/`
  - `SKILL.md`: Kiro CLI 专用 skill 指令
  - `automation-ref/`: Kiro CLI 版自动化脚本源参考

## implementation-audit 概览

该 skill 会把自动化脚本同步到 `automation/implementation-audit/`，并支持：

- 任务初始化：`init.sh`
- 执行：`.ai-workflows/<task-id>/run`
- 断点续跑：`.ai-workflows/<task-id>/continue`
- 手工恢复：`--from-phase` / `--from-round`

更完整说明见 `skills/implementation-audit/automation-ref/README.md`。

## implementation-audit-kiro 概览

该 skill 会把自动化脚本同步到 `automation/implementation-audit-kiro/`，并支持：

- 在目标项目生成 Kiro agent：`setup-kiro-agent.sh`
- 任务初始化：`init.sh`
- 执行：`.ai-workflows/<task-id>/run`
- 断点续跑：`.ai-workflows/<task-id>/continue`
- 手工恢复：`--from-phase` / `--from-round`

更完整说明见 `skills/implementation-audit-kiro/automation-ref/README.md`。

## 快速开始

初始化任务：

```bash
bash automation/implementation-audit/init.sh \
  --input docs/plans/2026-02-11-security-external-auth-design.md
```

运行任务：

```bash
./.ai-workflows/<auto-generated-task-id>/run
```

断点续跑：

```bash
./.ai-workflows/<auto-generated-task-id>/continue
```

## 资产同步模式

使用参考同步脚本：

```bash
bash automation/implementation-audit/sync-automation.sh \
  <path-to-ai-co-audit-skills>/skills/implementation-audit/automation-ref \
  automation/implementation-audit
```

需要强制覆盖时：

```bash
bash automation/implementation-audit/sync-automation.sh \
  <path-to-ai-co-audit-skills>/skills/implementation-audit/automation-ref \
  automation/implementation-audit \
  --auto-copy
```
